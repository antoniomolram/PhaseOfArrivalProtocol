<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MiXiM: src/base/modules/BaseMobility.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_e80fc4adf425b1e0d708b53057b2371a.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_6329d8696a731f6bb31584247928f698.html">base</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_d926ec15fff4ea07232cddcf27b48d54.html">modules</a>
  </div>
</div>
<div class="contents">
<h1>BaseMobility.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- mode:c++ -*- ********************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> * file:        BaseMobility.h</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * author:      Daniel Willkomm, Andras Varga</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * copyright:   (C) 2004 Telecommunication Networks Group (TKN) at</span>
<a name="l00007"></a>00007 <span class="comment"> *              Technische Universitaet Berlin, Germany.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *              (C) 2005 Andras Varga</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *              This program is free software; you can redistribute it</span>
<a name="l00012"></a>00012 <span class="comment"> *              and/or modify it under the terms of the GNU General Public</span>
<a name="l00013"></a>00013 <span class="comment"> *              License as published by the Free Software Foundation; either</span>
<a name="l00014"></a>00014 <span class="comment"> *              version 2 of the License, or (at your option) any later</span>
<a name="l00015"></a>00015 <span class="comment"> *              version.</span>
<a name="l00016"></a>00016 <span class="comment"> *              For further information see file COPYING</span>
<a name="l00017"></a>00017 <span class="comment"> *              in the top level directory</span>
<a name="l00018"></a>00018 <span class="comment"> ***************************************************************************</span>
<a name="l00019"></a>00019 <span class="comment"> * part of:     framework implementation developed by tkn</span>
<a name="l00020"></a>00020 <span class="comment"> **************************************************************************/</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#ifndef BASE_MOBILITY_H</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#define BASE_MOBILITY_H</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;MiXiMDefs.h&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;BatteryAccess.h&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;Coord.h&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;Move.h&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;BaseWorldUtility.h&quot;</span>
<a name="l00031"></a>00031 
<a name="l00061"></a><a class="code" href="a00023.html">00061</a> <span class="keyword">class </span>MIXIM_API <a class="code" href="a00023.html" title="Base module for all mobility modules.">BaseMobility</a> : <span class="keyword">public</span> <a class="code" href="a00028.html" title="Extends BaseModule by several methods which provide access to the battery module...">BatteryAccess</a>
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063   <span class="keyword">public</span>:
<a name="l00070"></a><a class="code" href="a00023.html#ab98fb8c368f0440f799b286082ab9692">00070</a>     <span class="keyword">enum</span> <a class="code" href="a00023.html#ab98fb8c368f0440f799b286082ab9692" title="Selects how a node should behave if it reaches the edge of the playground.">BorderPolicy</a> {
<a name="l00071"></a><a class="code" href="a00023.html#ab98fb8c368f0440f799b286082ab9692a829b74c4a43c1dcf653cefb1f013442c">00071</a>         REFLECT,       
<a name="l00072"></a><a class="code" href="a00023.html#ab98fb8c368f0440f799b286082ab9692aa1e7cff6cab8bb2e5377954240e5e9ff">00072</a>         WRAP,          
<a name="l00073"></a><a class="code" href="a00023.html#ab98fb8c368f0440f799b286082ab9692aba3a649e4ab9c49d2ba504eb267d6883">00073</a>         PLACERANDOMLY, 
<a name="l00074"></a><a class="code" href="a00023.html#ab98fb8c368f0440f799b286082ab9692a8e407aa7afa91b56f22fa0288cf64800">00074</a>         RAISEERROR     
<a name="l00075"></a>00075     };
<a name="l00076"></a>00076 
<a name="l00082"></a><a class="code" href="a00023.html#a4ff5688fe27813f0b48fbaaca7f77320">00082</a>     <span class="keyword">enum</span> <a class="code" href="a00023.html#a4ff5688fe27813f0b48fbaaca7f77320" title="The kind field of messages.">BaseMobilityMsgKinds</a> {
<a name="l00083"></a>00083         MOVE_HOST = 21311,
<a name="l00084"></a>00084         MOVE_TO_BORDER,
<a name="l00087"></a><a class="code" href="a00023.html#a4ff5688fe27813f0b48fbaaca7f77320af70de9be1467bc9627cb6087220ec40f">00087</a>     LAST_BASE_MOBILITY_KIND,
<a name="l00088"></a>00088     };
<a name="l00089"></a>00089 
<a name="l00093"></a><a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1">00093</a>     <span class="keyword">enum</span> <a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1" title="Specifies which border actually has been reached.">BorderHandling</a> {
<a name="l00094"></a><a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1a853b2e0d3f99c2f6d055d42f0232ddea">00094</a>       NOWHERE,   
<a name="l00095"></a><a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1ad18e65d34ff94919ea9852c030d623f0">00095</a>         X_SMALLER, 
<a name="l00096"></a><a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1a702032487f04b9f8175057934fa4c095">00096</a>     X_BIGGER,  
<a name="l00097"></a><a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1a7bc26c24e4f04e88bba2e6c1301ee80c">00097</a>     Y_SMALLER, 
<a name="l00098"></a><a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1af063b05510ed72bec2922676d5622ab9">00098</a>     Y_BIGGER,  
<a name="l00099"></a><a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1a9f9d36e258d30fc681cac3086bcfd5be">00099</a>     Z_SMALLER, 
<a name="l00100"></a><a class="code" href="a00023.html#aa9aa47015075d3e3caecd69a88ffe4c1a59d4a5a1d81e57d64160a91dfc051e36">00100</a>     Z_BIGGER   
<a name="l00101"></a>00101     };
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   <span class="keyword">protected</span>:
<a name="l00104"></a>00104 
<a name="l00106"></a><a class="code" href="a00023.html#a6622a6eae6f6fb4bc2511a9f2d7f0593">00106</a>     <a class="code" href="a00027.html" title="Provides information and utility methods for the whole simulation.">BaseWorldUtility</a> *world;
<a name="l00107"></a>00107 
<a name="l00109"></a><a class="code" href="a00023.html#a1034fe1aa236bfa5bc2ae4adf3de8da2">00109</a>     <a class="code" href="a00127.html" title="Class to store object position and movement.">Move</a> move;
<a name="l00110"></a>00110 
<a name="l00112"></a><a class="code" href="a00023.html#ac4f47a623fd8182dd444c28908d7d610">00112</a>     <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a> constraintAreaMin, constraintAreaMax;
<a name="l00113"></a>00113 
<a name="l00115"></a><a class="code" href="a00023.html#a40070f59b11031830ba8055882ef43dd">00115</a>     <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="a00177.html" title="Helper function to initialize signal change identifier on use and not on initializing...">simsignalwrap_t</a> mobilityStateChangedSignal;
<a name="l00116"></a>00116 
<a name="l00118"></a><a class="code" href="a00023.html#af3cdd1192cfb8e70e53f36d03a20f1b5">00118</a>     simtime_t updateInterval;
<a name="l00119"></a>00119 
<a name="l00121"></a><a class="code" href="a00023.html#ab4535d31d36713218b22de49a1ecb2d1">00121</a>     cMessage* moveMsg;
<a name="l00122"></a>00122 
<a name="l00124"></a><a class="code" href="a00023.html#aeb7ee6624bec58357e8fae54859c76c9">00124</a>     <span class="keywordtype">bool</span> coreDebug;
<a name="l00125"></a>00125 
<a name="l00128"></a><a class="code" href="a00023.html#a686f8eba70fe8093c6f24eabace93f17">00128</a>     <span class="keywordtype">bool</span> scaleNodeByDepth;
<a name="l00129"></a>00129 
<a name="l00131"></a><a class="code" href="a00023.html#a15a299a658a5656b05e36ef100752399">00131</a>     <span class="keywordtype">double</span> playgroundScaleX;
<a name="l00133"></a><a class="code" href="a00023.html#a366f2ef6324b7bfd4c04f235da9d077e">00133</a>     <span class="keywordtype">double</span> playgroundScaleY;
<a name="l00134"></a>00134 
<a name="l00136"></a><a class="code" href="a00023.html#af9f5b080a2f693930f895a0e99adfb46">00136</a>     <span class="keywordtype">double</span> origDisplayWidth;
<a name="l00138"></a><a class="code" href="a00023.html#a1e9e54a292ca10e81e6b3972e9b5ebbf">00138</a>     <span class="keywordtype">double</span> origDisplayHeight;
<a name="l00139"></a>00139 
<a name="l00141"></a><a class="code" href="a00023.html#aa729b28341a19fc6683cb8aea89fef3b">00141</a>     <span class="keywordtype">double</span> origIconSize;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143   <span class="keyword">private</span>:
<a name="l00146"></a>00146     <a class="code" href="a00023.html" title="Base module for all mobility modules.">BaseMobility</a>(<span class="keyword">const</span> <a class="code" href="a00023.html" title="Base module for all mobility modules.">BaseMobility</a>&amp;);
<a name="l00149"></a>00149     <a class="code" href="a00023.html" title="Base module for all mobility modules.">BaseMobility</a>&amp; <a class="code" href="a00028.html#ab077be2a7b0e17fed09b0e00f49225be" title="Assignment operator is not allowed.">operator=</a>(<span class="keyword">const</span> <a class="code" href="a00023.html" title="Base module for all mobility modules.">BaseMobility</a>&amp;);
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="keyword">public</span>:
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <a class="code" href="a00023.html" title="Base module for all mobility modules.">BaseMobility</a>();
<a name="l00155"></a>00155     <a class="code" href="a00023.html" title="Base module for all mobility modules.">BaseMobility</a>(<span class="keywordtype">unsigned</span> stacksize);
<a name="l00156"></a>00156 
<a name="l00162"></a>00162     <span class="keyword">virtual</span> <span class="keywordtype">void</span> handleMessage(cMessage *msg);
<a name="l00163"></a>00163 
<a name="l00178"></a>00178     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00024.html#a03030e439aaf030c83da6e71e8be2f80" title="Basic initialization for all modules.">initialize</a>(<span class="keywordtype">int</span>);
<a name="l00179"></a>00179 
<a name="l00181"></a><a class="code" href="a00023.html#a342341f600bd2ebdbe9f39b0c44f12f1">00181</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00023.html#a342341f600bd2ebdbe9f39b0c44f12f1" title="Delete dynamically allocated objects.">finish</a>() {};
<a name="l00182"></a>00182 
<a name="l00184"></a><a class="code" href="a00023.html#a43e40c6e56445ca9439d7d44a37b12c1">00184</a>     <span class="keyword">virtual</span> <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a> <a class="code" href="a00023.html#a43e40c6e56445ca9439d7d44a37b12c1" title="Returns the current position at the current simulation time.">getCurrentPosition</a>(<span class="comment">/*simtime_t_cref stWhen = simTime()*/</span>)<span class="keyword"> const </span>{
<a name="l00185"></a>00185       <span class="comment">//return move.getPositionAt(stWhen);</span>
<a name="l00186"></a>00186       <span class="keywordflow">return</span> move.getStartPos();
<a name="l00187"></a>00187     }
<a name="l00188"></a>00188 
<a name="l00190"></a><a class="code" href="a00023.html#a7dad57a3df9fc0e67b8eeb908a8b994f">00190</a>     <span class="keyword">virtual</span> <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a> <a class="code" href="a00023.html#a7dad57a3df9fc0e67b8eeb908a8b994f" title="Returns the current speed at the current simulation time.">getCurrentSpeed</a>()<span class="keyword"> const </span>{
<a name="l00191"></a>00191       <span class="keywordflow">return</span> move.getDirection() * move.getSpeed();
<a name="l00192"></a>00192     }
<a name="l00193"></a>00193   <span class="keyword">protected</span>:
<a name="l00200"></a>00200     <span class="keyword">virtual</span> <span class="keywordtype">int</span> iconSizeTagToSize(<span class="keyword">const</span> <span class="keywordtype">char</span>* tag);
<a name="l00201"></a>00201 
<a name="l00209"></a>00209   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* iconSizeToTag(<span class="keywordtype">double</span> size);
<a name="l00210"></a>00210 
<a name="l00220"></a>00220     <span class="keyword">virtual</span> <span class="keywordtype">void</span> handleSelfMsg( cMessage* );
<a name="l00221"></a>00221 
<a name="l00231"></a>00231     <span class="keyword">virtual</span> <span class="keywordtype">void</span> handleBorderMsg( cMessage* );
<a name="l00232"></a>00232 
<a name="l00242"></a><a class="code" href="a00023.html#a9774524fd5f2d3ef348dc67f2af0f491">00242</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00023.html#a9774524fd5f2d3ef348dc67f2af0f491" title="Moves the host.">makeMove</a>(){
<a name="l00243"></a>00243       error(<span class="stringliteral">&quot;BaseMobility does not move the host&quot;</span>);
<a name="l00244"></a>00244     };
<a name="l00245"></a>00245 
<a name="l00255"></a>00255     <span class="keyword">virtual</span> <span class="keywordtype">void</span> updatePosition();
<a name="l00256"></a>00256 
<a name="l00258"></a><a class="code" href="a00023.html#afd83457f242d92ccdc2e2b5a3b2c4dd8">00258</a>     <span class="keywordtype">double</span> <a class="code" href="a00023.html#afd83457f242d92ccdc2e2b5a3b2c4dd8" title="Returns the width of the playground.">playgroundSizeX</a>()<span class="keyword"> const  </span>{<span class="keywordflow">return</span> world-&gt;getPgs()-&gt;x;}
<a name="l00259"></a>00259 
<a name="l00261"></a><a class="code" href="a00023.html#a09941dabdb81e67c77fc4794167c9351">00261</a>     <span class="keywordtype">double</span> <a class="code" href="a00023.html#a09941dabdb81e67c77fc4794167c9351" title="Returns the height of the playground.">playgroundSizeY</a>()<span class="keyword"> const  </span>{<span class="keywordflow">return</span> world-&gt;getPgs()-&gt;y;}
<a name="l00262"></a>00262 
<a name="l00264"></a><a class="code" href="a00023.html#a1245dec457a2d33c8dd1a70ccd74ea33">00264</a>     <span class="keywordtype">double</span> <a class="code" href="a00023.html#a1245dec457a2d33c8dd1a70ccd74ea33" title="Returns the height of the playground.">playgroundSizeZ</a>()<span class="keyword"> const  </span>{<span class="keywordflow">return</span> world-&gt;getPgs()-&gt;z;}
<a name="l00265"></a>00265 
<a name="l00267"></a><a class="code" href="a00023.html#a8fa3e89fe9d550dfd95c341fcaa77e31">00267</a>   <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a> <a class="code" href="a00023.html#a8fa3e89fe9d550dfd95c341fcaa77e31" title="Random position somewhere in the playground. DEPRECATED: Use BaseWorldUtility::getRandomPosition()...">getRandomPosition</a>() {
<a name="l00268"></a>00268     <span class="keywordflow">return</span> <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>( (constraintAreaMin.x &lt; constraintAreaMax.x)
<a name="l00269"></a>00269                     ? uniform(constraintAreaMin.x, constraintAreaMax.x)
<a name="l00270"></a>00270                     : constraintAreaMin.x
<a name="l00271"></a>00271                 , (constraintAreaMin.y &lt; constraintAreaMax.y)
<a name="l00272"></a>00272                   ? uniform(constraintAreaMin.y, constraintAreaMax.y)
<a name="l00273"></a>00273                   : constraintAreaMin.y
<a name="l00274"></a>00274                 , (constraintAreaMin.z &lt; constraintAreaMax.z)
<a name="l00275"></a>00275                   ? uniform(constraintAreaMin.z, constraintAreaMax.z)
<a name="l00276"></a>00276                   : constraintAreaMin.z );
<a name="l00277"></a>00277   }
<a name="l00278"></a>00278 
<a name="l00287"></a>00287 
<a name="l00315"></a>00315     <span class="keywordtype">bool</span> handleIfOutside(BorderPolicy, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;, <span class="keywordtype">double</span>&amp;);
<a name="l00316"></a>00316 
<a name="l00329"></a><a class="code" href="a00023.html#acf49d9a33d055f987e4d978af8e3a30c">00329</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00023.html#acf49d9a33d055f987e4d978af8e3a30c" title="Should be redefined in subclasses.">fixIfHostGetsOutside</a>(){
<a name="l00330"></a>00330       error(<span class="stringliteral">&quot;fixIfHostGetsOutside has to be redefined by the user&quot;</span>);
<a name="l00331"></a>00331     };
<a name="l00332"></a>00332 
<a name="l00343"></a>00343     BorderHandling checkIfOutside( <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp; );
<a name="l00344"></a>00344 
<a name="l00351"></a>00351     <span class="keywordtype">void</span> goToBorder( BorderPolicy, BorderHandling, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp; );
<a name="l00352"></a>00352 
<a name="l00363"></a>00363     <span class="keywordtype">void</span> reflectCoordinate(BorderHandling border, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp; c);
<a name="l00364"></a>00364 
<a name="l00380"></a>00380     <span class="keywordtype">void</span> reflectIfOutside(BorderHandling, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;, <span class="keywordtype">double</span>&amp;);
<a name="l00381"></a>00381 
<a name="l00393"></a>00393     <span class="keywordtype">void</span> wrapIfOutside(BorderHandling, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;, <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp;);
<a name="l00394"></a>00394 
<a name="l00405"></a>00405     <span class="keywordtype">void</span> placeRandomlyIfOutside( <a class="code" href="a00062.html" title="Class for storing 3D coordinates.">Coord</a>&amp; );
<a name="l00406"></a>00406 
<a name="l00409"></a>00409 };
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 <span class="preprocessor">#endif</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed Dec 14 16:01:42 2011 for MiXiM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
