<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MiXiM: SimpleMacLayer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>SimpleMacLayer Class Reference<br/>
<small>
[<a class="el" href="a00462.html">AnalogueModels example - Classes from the AnalogueModels example</a>]</small>
</h1><!-- doxytag: class="SimpleMacLayer" --><!-- doxytag: inherits="BaseModule" -->
<p>A simple Mac layer implementation which only shows how to create Signals, send them to Phy and receive the from the Phy layer.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00211_source.html">SimpleMacLayer.h</a>&gt;</code></p>

<p>Inherits <a class="el" href="a00024.html">BaseModule</a>.</p>
<div class="dynheader">
Collaboration diagram for SimpleMacLayer:</div>
<div class="dynsection">
<div class="center"><img src="a00770.png" border="0" usemap="#SimpleMacLayer_coll__map" alt="Collaboration graph"/></div>
<map name="SimpleMacLayer_coll__map" id="SimpleMacLayer_coll__map">
<area shape="rect" href="a00024.html" title="Base class for all simple modules of a host." alt="" coords="5,8,101,35"/><area shape="rect" href="a00119.html" title="Defines the methods provided by the phy to the mac layer." alt="" coords="125,8,261,35"/><area shape="rect" href="a00083.html" title="Represents a set of dimensions which is used to define over which dimensions a mapping..." alt="" coords="285,8,389,35"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="a00771.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#a9a23cdc88daa658398f0bc10ac4ed219">initialize</a> (int stage)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Basic initialization for all modules.  <a href="#a9a23cdc88daa658398f0bc10ac4ed219"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a54dbbc7fdd99fc056baab98061420258"></a><!-- doxytag: member="SimpleMacLayer::handleMessage" ref="a54dbbc7fdd99fc056baab98061420258" args="(cMessage *msg)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>handleMessage</b> (cMessage *msg)</td></tr>
<tr><td colspan="2"><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="a00172.html#abfa6d561f6a78e4067a27434d766225fa4b9a5853e8ca522bc3f0be62c042d894">TEST_MACPKT</a> =  12121
 }</td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a376421d6d86692c47dacaaebfd21ebd7"></a><!-- doxytag: member="SimpleMacLayer::createMapping" ref="a376421d6d86692c47dacaaebfd21ebd7" args="(simtime_t_cref time, simtime_t_cref length, double freqFrom, double freqTo, double value)" -->
<a class="el" href="a00121.html">Mapping</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#a376421d6d86692c47dacaaebfd21ebd7">createMapping</a> (simtime_t_cref time, simtime_t_cref length, double freqFrom, double freqTo, double value)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a <a class="el" href="a00121.html" title="Represents a changeable mapping (mathematical function) from at least time to Argument::mapped_type...">Mapping</a> with the passed value at the passed position in freqency and time. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a91e83a4243796e1614c3cfa423f03d49"></a><!-- doxytag: member="SimpleMacLayer::handleMacPkt" ref="a91e83a4243796e1614c3cfa423f03d49" args="(MacPkt *pkt)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>handleMacPkt</b> (MacPkt *pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="affce6782f24929b0620d77e43849cd1d"></a><!-- doxytag: member="SimpleMacLayer::handleTXOver" ref="affce6782f24929b0620d77e43849cd1d" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>handleTXOver</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a24a84df3fe2796c6ef724227dd6293bd"></a><!-- doxytag: member="SimpleMacLayer::broadCastPacket" ref="a24a84df3fe2796c6ef724227dd6293bd" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#a24a84df3fe2796c6ef724227dd6293bd">broadCastPacket</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends the answer packet. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a00e2a106b0e32dbef1a868227abe500d"></a><!-- doxytag: member="SimpleMacLayer::sendDown" ref="a00e2a106b0e32dbef1a868227abe500d" args="(MacPkt *pkt)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>sendDown</b> (MacPkt *pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7e0a804b2cc82aa06203738bfec76b3b"></a><!-- doxytag: member="SimpleMacLayer::createMacPkt" ref="a7e0a804b2cc82aa06203738bfec76b3b" args="(simtime_t_cref length)" -->
MacPkt *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#a7e0a804b2cc82aa06203738bfec76b3b">createMacPkt</a> (simtime_t_cref length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates the answer packet. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a40e1a41bf783a5ca9525dcbfca6d7ace"></a><!-- doxytag: member="SimpleMacLayer::log" ref="a40e1a41bf783a5ca9525dcbfca6d7ace" args="(std::string msg)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>log</b> (std::string msg)</td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7ed88006647e680895f4737464fc639"></a><!-- doxytag: member="SimpleMacLayer::phy" ref="ad7ed88006647e680895f4737464fc639" args="" -->
<a class="el" href="a00119.html">MacToPhyInterface</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#ad7ed88006647e680895f4737464fc639">phy</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the phy module of this host. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6bef5234e57995505bed24b48e68f77a"></a><!-- doxytag: member="SimpleMacLayer::dataOut" ref="a6bef5234e57995505bed24b48e68f77a" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#a6bef5234e57995505bed24b48e68f77a">dataOut</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Omnet gates. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba6cf264f7ce298a44fc553a1de23f0f"></a><!-- doxytag: member="SimpleMacLayer::dataIn" ref="aba6cf264f7ce298a44fc553a1de23f0f" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>dataIn</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1f46921b1c45cc87f0ffe1bf442b4e3d"></a><!-- doxytag: member="SimpleMacLayer::myIndex" ref="a1f46921b1c45cc87f0ffe1bf442b4e3d" args="" -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><b>myIndex</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a67addba2fe8f0c3cccb46662b8d97038"></a><!-- doxytag: member="SimpleMacLayer::nextReceiver" ref="a67addba2fe8f0c3cccb46662b8d97038" args="" -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#a67addba2fe8f0c3cccb46662b8d97038">nextReceiver</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The index of the host the next packet should be send to. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a22ca1a18e1bed2f5875c1cca654a9a88"></a><!-- doxytag: member="SimpleMacLayer::dimensions" ref="a22ca1a18e1bed2f5875c1cca654a9a88" args="" -->
<a class="el" href="a00083.html">DimensionSet</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#a22ca1a18e1bed2f5875c1cca654a9a88">dimensions</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The dimensions for the signal this mac layer works with (frequency and time). <br/></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2cfd124e320077ba48c03d59b695b646"></a><!-- doxytag: member="SimpleMacLayer::SimpleMacLayer" ref="a2cfd124e320077ba48c03d59b695b646" args="(const SimpleMacLayer &amp;)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#a2cfd124e320077ba48c03d59b695b646">SimpleMacLayer</a> (const <a class="el" href="a00172.html">SimpleMacLayer</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy constructor is not allowed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab94865cc9947b44466914291b37a2eac"></a><!-- doxytag: member="SimpleMacLayer::operator=" ref="ab94865cc9947b44466914291b37a2eac" args="(const SimpleMacLayer &amp;)" -->
<a class="el" href="a00172.html">SimpleMacLayer</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00172.html#ab94865cc9947b44466914291b37a2eac">operator=</a> (const <a class="el" href="a00172.html">SimpleMacLayer</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assignment operator is not allowed. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>A simple Mac layer implementation which only shows how to create Signals, send them to Phy and receive the from the Phy layer. </p>
<p>This Mac layer just sends an answer packet every time it receives a packet. Since both hosts do that in this simulation, it will only terminate if one packet gets lost (couldn't be received by the phy layer correctly). </p>

<p>Definition at line <a class="el" href="a00211_source.html#l00022">22</a> of file <a class="el" href="a00211_source.html">SimpleMacLayer.h</a>.</p>
<hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="abfa6d561f6a78e4067a27434d766225f"></a><!-- doxytag: member="SimpleMacLayer::@1" ref="abfa6d561f6a78e4067a27434d766225f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="abfa6d561f6a78e4067a27434d766225fa4b9a5853e8ca522bc3f0be62c042d894"></a><!-- doxytag: member="TEST_MACPKT" ref="abfa6d561f6a78e4067a27434d766225fa4b9a5853e8ca522bc3f0be62c042d894" args="" -->TEST_MACPKT</em>&nbsp;</td><td>
<p>Used as Message kind to identify MacPackets. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="a00211_source.html#l00044">44</a> of file <a class="el" href="a00211_source.html">SimpleMacLayer.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00044"></a>00044        {
<a name="l00046"></a>00046     <a class="code" href="a00172.html#abfa6d561f6a78e4067a27434d766225fa4b9a5853e8ca522bc3f0be62c042d894" title="Used as Message kind to identify MacPackets.">TEST_MACPKT</a> = 12121
<a name="l00047"></a>00047   };
</pre></div></p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a9a23cdc88daa658398f0bc10ac4ed219"></a><!-- doxytag: member="SimpleMacLayer::initialize" ref="a9a23cdc88daa658398f0bc10ac4ed219" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SimpleMacLayer::initialize </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Basic initialization for all modules. </p>
<p>Subscription should be in stage==0, and firing notifications in stage==1 or later.</p>
<p>NOTE: You have to call this in the <a class="el" href="a00172.html#a9a23cdc88daa658398f0bc10ac4ed219" title="Basic initialization for all modules.">initialize()</a> function of the inherited class! </p>

<p>Reimplemented from <a class="el" href="a00024.html#a03030e439aaf030c83da6e71e8be2f80">BaseModule</a>.</p>

<p>Definition at line <a class="el" href="a00210_source.html#l00016">16</a> of file <a class="el" href="a00210_source.html">SimpleMacLayer.cc</a>.</p>

<p>References <a class="el" href="a00273_source.html#l00298">DimensionSet::addDimension()</a>, <a class="el" href="a00211_source.html#l00036">dataOut</a>, <a class="el" href="a00211_source.html#l00050">dimensions</a>, <a class="el" href="a00246_source.html#l00093">BaseModule::findHost()</a>, <a class="el" href="a00273_source.html#l00084">Dimension::frequency</a>, <a class="el" href="a00211_source.html#l00042">nextReceiver</a>, <a class="el" href="a00211_source.html#l00033">phy</a>, <a class="el" href="a00278_source.html#l00206">Radio::RX</a>, <a class="el" href="a00119.html#ad25abbad9aa16bdbf24bf1dd582b1c6f">MacToPhyInterface::setRadioState()</a>, <a class="el" href="a00273_source.html#l00080">Dimension::time</a>, and <a class="el" href="a00278_source.html#l00208">Radio::TX</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00016"></a>00016                                          {
<a name="l00017"></a>00017   <a class="code" href="a00172.html#a9a23cdc88daa658398f0bc10ac4ed219" title="Basic initialization for all modules.">BaseModule::initialize</a>(stage);
<a name="l00018"></a>00018 
<a name="l00019"></a>00019   <span class="keywordflow">if</span>(stage == 0) {
<a name="l00020"></a>00020     myIndex = <a class="code" href="a00024.html#aabf0226159b22b46e70031fd3bb3b1b2" title="Function to get a pointer to the host module.">findHost</a>()-&gt;getIndex();
<a name="l00021"></a>00021 
<a name="l00022"></a>00022     <a class="code" href="a00172.html#a22ca1a18e1bed2f5875c1cca654a9a88" title="The dimensions for the signal this mac layer works with (frequency and time).">dimensions</a>.<a class="code" href="a00083.html#a397190b81dbfde450e4fe1e47633fb39" title="Adds the passed dimension to the DimensionSet.">addDimension</a>(<a class="code" href="a00082.html#a16cb1f186dd3f48d33a4aebe948001d7" title="Shortcut to the time Dimension, same as &amp;#39;Dimension(&amp;quot;time&amp;quot;)&amp;#39;, but...">Dimension::time</a>);
<a name="l00023"></a>00023     <a class="code" href="a00172.html#a22ca1a18e1bed2f5875c1cca654a9a88" title="The dimensions for the signal this mac layer works with (frequency and time).">dimensions</a>.<a class="code" href="a00083.html#a397190b81dbfde450e4fe1e47633fb39" title="Adds the passed dimension to the DimensionSet.">addDimension</a>(<a class="code" href="a00082.html#ad4360e7d88c881d06ee61033ad99d66f" title="Shortcut to the frequency Dimension, same as &amp;#39;Dimension(&amp;quot;frequency&amp;quot;)&amp;#39;...">Dimension::frequency</a>);
<a name="l00024"></a>00024 
<a name="l00025"></a>00025     <a class="code" href="a00172.html#a6bef5234e57995505bed24b48e68f77a" title="Omnet gates.">dataOut</a> = findGate(<span class="stringliteral">&quot;lowerLayerOut&quot;</span>);
<a name="l00026"></a>00026     dataIn  = findGate(<span class="stringliteral">&quot;lowerLayerIn&quot;</span>);
<a name="l00027"></a>00027 
<a name="l00028"></a>00028     <a class="code" href="a00172.html#ad7ed88006647e680895f4737464fc639" title="Pointer to the phy module of this host.">phy</a> = <a class="code" href="a00090.html" title="Provides method templates to find omnet modules.">FindModule&lt;MacToPhyInterface*&gt;::findSubModule</a>(this-&gt;getParentModule());
<a name="l00029"></a>00029 
<a name="l00030"></a>00030   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stage == 1) {
<a name="l00031"></a>00031     <span class="keywordflow">if</span>(myIndex == 0){ <span class="comment">//host with index 0 start with sending packets</span>
<a name="l00032"></a>00032       log(<span class="stringliteral">&quot;Switching radio to TX...&quot;</span>);
<a name="l00033"></a>00033       <a class="code" href="a00172.html#a67addba2fe8f0c3cccb46662b8d97038" title="The index of the host the next packet should be send to.">nextReceiver</a> = 1;
<a name="l00034"></a>00034       <a class="code" href="a00172.html#ad7ed88006647e680895f4737464fc639" title="Pointer to the phy module of this host.">phy</a>-&gt;<a class="code" href="a00119.html#ad25abbad9aa16bdbf24bf1dd582b1c6f" title="Tells the BasePhyLayer to switch to the specified radio state.">setRadioState</a>(<a class="code" href="a00158.html#a7314de88eaecfa054e682ccc84ef0ffaa55eab2480eb0876c6b76dc0df92882f7" title="transmitting state">Radio::TX</a>); <span class="comment">//to be able to send packets it has to switch to TX mode</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036     }<span class="keywordflow">else</span>{ <span class="comment">//every other host start in receiving mode</span>
<a name="l00037"></a>00037       log(<span class="stringliteral">&quot;Switching radio to RX...&quot;</span>);
<a name="l00038"></a>00038       <a class="code" href="a00172.html#ad7ed88006647e680895f4737464fc639" title="Pointer to the phy module of this host.">phy</a>-&gt;<a class="code" href="a00119.html#ad25abbad9aa16bdbf24bf1dd582b1c6f" title="Tells the BasePhyLayer to switch to the specified radio state.">setRadioState</a>(<a class="code" href="a00158.html#a7314de88eaecfa054e682ccc84ef0ffaa0a9f9ba2fd83cf0f5f4eaf4f32d6a9c1" title="receiving state">Radio::RX</a>);
<a name="l00039"></a>00039     }
<a name="l00040"></a>00040     <span class="comment">//switching the radio can take some time,</span>
<a name="l00041"></a>00041     <span class="comment">//we will get a &quot;RADIO_SWITCHING_OVER&quot; message as soon as the radio has switched.</span>
<a name="l00042"></a>00042   }
<a name="l00043"></a>00043 }
</pre></div></p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>examples/analogueModels/<a class="el" href="a00211_source.html">SimpleMacLayer.h</a></li>
<li>examples/analogueModels/<a class="el" href="a00210_source.html">SimpleMacLayer.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed Dec 14 16:01:51 2011 for MiXiM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
